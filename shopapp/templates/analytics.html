{% extends "layout.html" %}
{% block title %}Analytics Â· ShopApp{% endblock %}
{% block content %}

<div class="aurora" aria-hidden="true"></div>

<section class="card">
  <h1><span class="gradientAnim">Analytics.</span> Clarity meets glow.</h1>
  <p class="subtle" style="margin-top:6px;">Visualize revenue, expenses, and profit curves.</p>
</section>

<section class="grid-4">
  <div class="card kpi"><div class="coin">ðŸ’°</div><div><div class="kpiTitle">Revenue</div><div class="kpiValue" data-count="{{ analytics.summary.total_revenue or 0 }}">â‚¹0</div></div></div>
  <div class="card kpi"><div class="coin">ðŸ§¾</div><div><div class="kpiTitle">Expenses</div><div class="kpiValue" data-count="{{ analytics.summary.total_expenses or 0 }}">â‚¹0</div></div></div>
  <div class="card kpi"><div class="coin">ðŸ“ˆ</div><div><div class="kpiTitle">Profit</div><div class="kpiValue" data-count="{{ analytics.summary.total_profit or 0 }}">â‚¹0</div></div></div>
  <div class="card kpi"><div class="coin">âš¡</div><div><div class="kpiTitle">Daily avg</div><div class="kpiValue" data-count="{{ analytics.summary.average_daily_profit or 0 }}">â‚¹0</div></div></div>
</section>

<section class="card">
  <canvas id="revExp" height="180"></canvas>
</section>

{% endblock %}
{% block scripts %}
{{ super() }}
<script>
document.querySelectorAll('.kpiValue[data-count]').forEach(el=>ShopFX.countUp(el,{money:true}));
const A={{ analytics or {} | tojson }}, ctx=document.getElementById('revExp');
if(ctx&&A.daily){new Chart(ctx,{type:'line',data:{
labels:A.daily.map(r=>r.label),
datasets:[
{label:'Revenue',data:A.daily.map(r=>r.revenue),borderColor:'#7c3aed',backgroundColor:'rgba(124,58,237,.2)',tension:.38,fill:true},
{label:'Expenses',data:A.daily.map(r=>r.expenses),borderColor:'#06b6d4',backgroundColor:'rgba(6,182,212,.18)',tension:.38,fill:true},
{label:'Profit',data:A.daily.map(r=>r.profit),borderColor:'#22c55e',backgroundColor:'rgba(34,197,94,.18)',tension:.38,fill:true}]},
options:{plugins:{legend:{labels:{color:'#fff'}}},scales:{x:{grid:{color:'rgba(255,255,255,.08)'}},y:{grid:{color:'rgba(255,255,255,.08)'}}}}});}
</script>
{% endblock %}
