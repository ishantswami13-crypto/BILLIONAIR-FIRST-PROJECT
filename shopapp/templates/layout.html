<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{% block title %}ShopApp{% endblock %}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">
  {% block head %}{% endblock %}
</head>
{% set current_path = request.path %}
<body class="{{ body_class or 'theme-mint' }}">
  <div class="shell">
    <aside class="sidebar">
      <div class="brand">🛍️ {{ shop_profile.name if shop_profile else "ShopApp" }}</div>
      <nav class="nav">
        <a href="{{ url_for('sales.index') }}" class="{% if current_path in ('/app', '/app/') %}active{% endif %}">🏠 Dashboard</a>
        <a href="{{ url_for('sales.history') }}" class="{% if current_path.startswith('/app/sales') %}active{% endif %}">🧾 Sales</a>
        <a href="{{ url_for('credits.outstanding') }}" class="{% if current_path.startswith('/credits') %}active{% endif %}">📒 Credits</a>
        <a href="{{ url_for('customers.customers') }}" class="{% if current_path.startswith('/customers') %}active{% endif %}">👥 Customers</a>
        <a href="{{ url_for('expenses.expenses') }}" class="{% if current_path.startswith('/expenses') %}active{% endif %}">💸 Expenses</a>
        <a href="{{ url_for('reports.analytics_view') }}" class="{% if current_path.startswith('/analytics') %}active{% endif %}">📈 Analytics</a>
        <a href="{{ url_for('settings.branding') }}" class="{% if current_path.startswith('/settings') %}active{% endif %}">⚙️ Settings</a>
        <a href="{{ url_for('assistant.chat_home') }}" class="{% if current_path.startswith('/assistant') %}active{% endif %}">🤖 Assistant</a>
      </nav>
      <hr>
      <div class="small">
        Plan: {{ active_plan or 'FREE' }} · Version: {{ app_version or 'v0.5' }}<br>
        Security: {{ encryption_notice or 'AES-256 at rest' }}
      </div>
    </aside>
    <main class="main">
      <div class="d-flex justify-content-between align-items-center mb-3">
        <div class="badge-soft">🔥 {{ streak_text or 'Close more sales today!' }}</div>
        {% if session.get('user') %}
          <div class="small text-muted">Hi, {{ session['user'] }} · <a href="{{ url_for('auth.logout') }}">Logout</a></div>
        {% endif %}
      </div>
      {% block content %}{% endblock %}
    </main>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  {% block scripts %}{% endblock %}
</body>
</html>
