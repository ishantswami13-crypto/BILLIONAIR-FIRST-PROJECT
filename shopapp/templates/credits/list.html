{% extends "layout.html" %}
{% block title %}Credits{% endblock %}
{% block content %}
<section class="card fadeUp">
  <div style="display:flex;justify-content:space-between;align-items:center;">
    <div>
      <h1 style="font-size:var(--f-xl);font-weight:700;">Credit Ledger</h1>
      <p style="color:var(--ink-60)">Track dues, send WhatsApp reminders, mark paid.</p>
    </div>
    <div>
      <form method="post" action="/credits/toggle-auto">
        <button class="btn">{{ 'Disable Auto Reminders' if auto_enabled else 'Enable Auto Reminders' }}</button>
      </form>
    </div>
  </div>
  <table class="table" style="margin-top:14px;">
    <thead><tr><th>Date</th><th>Customer</th><th>Item</th><th>Qty</th><th>Total</th><th>Status</th><th>Reminder</th><th></th></tr></thead>
    <tbody>
      {% for c in credits %}
      <tr>
        <td>{{ c.date }}</td><td>{{ c.customer_name }}</td><td>{{ c.item }}</td><td>{{ c.quantity }}</td><td>₹{{ '%.2f'|format(c.total) }}</td>
        <td><span class="badge {{ 'ok' if c.status=='paid' else 'warn' }}">{{ c.status|capitalize }}</span></td>
        <td style="color:var(--ink-60)">{{ c.last_reminder_at or '—' }}</td>
        <td style="text-align:right">
          <a class="btn" href="/credits/send/{{ c.id }}">Send now</a>
          {% if c.status!='paid' %}<a class="btn primary" href="/credits/pay/{{ c.id }}">Mark paid</a>{% endif %}
        </td>
      </tr>
      {% else %}
      <tr><td colspan="8" style="color:var(--ink-60)">No credit entries.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endblock %}
