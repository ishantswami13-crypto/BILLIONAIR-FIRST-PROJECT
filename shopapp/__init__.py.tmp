from decimal import Decimal

from flask import Flask

from .config import Config
from .extensions import db, migrate, scheduler
from .marketing import marketing_bp
from .admin import admin_bp
from .settings import settings_bp
from .assistant import assistant_bp
from .auth.routes import auth_bp
from .sales.routes import sales_bp
from .reports.routes import reports_bp
from .inventory.routes import inventory_bp
from .expenses.routes import expenses_bp
from .credits import credits_bp
from .customers.routes import customers_bp
from .webhooks import webhooks_bp
from .cli import register_cli
from .utils.mail import init_mail_settings
from .utils.feature_flags import feature_enabled, get_active_plan, reset_cache as reset_plan_cache
from .security import can_access, get_current_role
import daily_report
from .credits.tasks import send_credit_reminders
import drive_backup
from sqlalchemy import inspect, text
from sqlalchemy.exc import SQLAlchemyError

from .utils.schema import ensure_columns
from .models import Plan, PlanFeature, ShopProfile, User, UserRole
from .plans import BASE_FEATURES

